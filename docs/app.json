[{"name":"app.R","content":"library(shiny)\r\nlibrary(bslib)\r\nlibrary(dplyr)\r\nlibrary(gt)\r\n\r\nrandom_names <- babynames::babynames |>\r\n  filter(year == 2010) |>\r\n  pull(name) |> sample(size = 15)\r\n\r\nsecret_santa_randomizer <- \\(participants) {\r\n  \r\n  giver <- participants\r\n  \r\n  recipients <- giver\r\n  \r\n  data <- tibble(giver = giver,\r\n                 recipients = recipients)\r\n  \r\n  i <- 0\r\n  while(any(data$giver == data$recipients)) {\r\n    i <- i + 1\r\n    data <- tibble(giver = sample(giver),\r\n                   recipients = sample(recipients))\r\n    \r\n  }\r\n  \r\n  data <- data |> \r\n    mutate(\r\n      results = paste0(giver, \" -> \", recipients)\r\n    )\r\n  \r\n  tibble::lst(\r\n    data,\r\n    i\r\n  )\r\n  \r\n}\r\n\r\ndata <- secret_santa_randomizer(\r\n  babynames::babynames |>\r\n    filter(year == 2010) |>\r\n    pull(name) |> sample(size = 10)\r\n)\r\n\r\n\r\nui <- bslib::page_sidebar(\r\n  theme = bslib::bs_theme(version = 5, bootswatch = \"minty\"),\r\n  title = \"Secret Santa Randomizer\",\r\n  fillable = FALSE,\r\n  sidebar = sidebar(\r\n    selectizeInput(\r\n      inputId = \"participants\",\r\n      label = \"Participants\",\r\n      choices = random_names,\r\n      selected = random_names,\r\n      options = list(create = TRUE),\r\n      multiple = TRUE\r\n    ),\r\n    actionButton(\r\n      inputId = \"randomize\",\r\n      label = \"Randomize\"\r\n    )\r\n  ),\r\n  value_box(\r\n    title = 'Iterations',\r\n    value = textOutput('iterations'),\r\n    showcase = icon(\"users\"),\r\n    height = 150\r\n  ),\r\n  card(\r\n    card_header(\"Participants\",\r\n                status = \"primary\"),\r\n    card_body(\r\n      gt::gt_output(\"res\")),\r\n    fill = TRUE\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n\r\n  results <- eventReactive(input$randomize, {\r\n\r\n    secret_santa_randomizer(input$participants)\r\n    \r\n  })\r\n\r\n  output$res <- gt::render_gt({\r\n    \r\n    results()$data |> \r\n      gt() |> \r\n      cols_label(giver = \"Giver\",\r\n                 recipients = \"Recipients\",\r\n                 results = \"Results\")\r\n    \r\n  })\r\n  \r\n  output$iterations <- renderText({\r\n    \r\n    results()$i\r\n      \r\n  })\r\n  \r\n}\r\n\r\nshinyApp(ui, server)","type":"text"}]
